$(window).scroll(function(){
    if($(document).height() - 2000 < ($(document).scrollTop() + $(window).height())) {
      scrollNode = $('#more').last();    
      scrollURL = $('#more p a').last().attr("href");
      console.log(scrollURL);
      if(scrollNode.length > 0 && scrollNode.css('display') != 'none') {
        
        $.ajax({
          type: 'GET',
          url: scrollURL,
          beforeSend: function() {
//             scrollNode.clone().empty().insertAfter(scrollNode).append('Loading..');
			scrollNode.clone().empty().insertAfter(scrollNode).append('<svg width="64" height="64" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-rolling" style="background:none"><circle cx="50" cy="50" fill="none" stroke="#ccc" stroke-width="6" r="24" stroke-dasharray="113.09733552923255 39.69911184307752" transform="rotate(132 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"/></circle></svg>');
            scrollNode.hide();
          },
          success: function(data) {
            $('#more').remove();
            $('.more').remove();
            // remove loading feedback
            scrollNode.next().remove();
            
            $(data).find('#more').insertAfter( $("#product-list-foot") );

            var filteredData = $(data).find(".product");
            filteredData.insertBefore( $("#product-list-foot") );       
//             $(data).find('#more').insertBefore( $("#product-list-foot") );
            console.log($(data).find('#more'));
          },
          dataType: "html"
        });
      }
    }
});
